"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.convertIssue = exports.isResultCliError = void 0;
const types_1 = require("../common/languageServer/types");
var OssSeverity;
(function (OssSeverity) {
    OssSeverity["Low"] = "low";
    OssSeverity["Medium"] = "medium";
    OssSeverity["High"] = "high";
    OssSeverity["Critical"] = "critical";
})(OssSeverity || (OssSeverity = {}));
function isResultCliError(fileResult) {
    return fileResult.error !== undefined;
}
exports.isResultCliError = isResultCliError;
function convertSeverity(severity) {
    switch (severity) {
        case types_1.IssueSeverity.Low:
            return OssSeverity.Low;
        case types_1.IssueSeverity.Medium:
            return OssSeverity.Medium;
        case types_1.IssueSeverity.High:
            return OssSeverity.High;
        default:
            return OssSeverity.Critical;
    }
}
function convertIssue(issue) {
    const tempVuln = {
        id: issue.id,
        identifiers: issue.additionalData.identifiers,
        title: issue.title,
        description: issue.additionalData.description,
        language: issue.additionalData.language,
        packageManager: issue.additionalData.packageManager,
        packageName: issue.additionalData.packageName,
        severity: convertSeverity(issue.severity),
        name: issue.additionalData.name,
        version: issue.additionalData.version,
        exploit: issue.additionalData.exploit,
        CVSSv3: issue.additionalData.CVSSv3,
        cvssScore: issue.additionalData.cvssScore,
        fixedIn: issue.additionalData.fixedIn === undefined ? [] : issue.additionalData.fixedIn,
        from: issue.additionalData.from,
        upgradePath: issue.additionalData.upgradePath,
        isPatchable: issue.additionalData.isPatchable,
        isUpgradable: issue.additionalData.isUpgradable,
    };
    if (issue.additionalData.license !== undefined) {
        tempVuln.license = issue.additionalData.license;
    }
    return tempVuln;
}
exports.convertIssue = convertIssue;
//# sourceMappingURL=interfaces.js.map